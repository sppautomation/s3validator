<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="for IBM Spectrum Protect Plus (DEVELOPMENT)">
<title>Storage SDK Developer Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Storage SDK Developer Guide</h1>
<div class="details">
<span id="author" class="author">for IBM Spectrum Protect Plus (DEVELOPMENT)</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_advantages">1.1. Advantages</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_terminology">2.1. Terminology</a></li>
<li><a href="#_requirements">2.2. Requirements</a></li>
</ul>
</li>
<li><a href="#_getting_started">3. Getting Started</a></li>
<li><a href="#_framework">4. Framework</a>
<ul class="sectlevel2">
<li><a href="#_documentation">4.1. Documentation</a></li>
<li><a href="#_logging">4.2. Logging</a></li>
<li><a href="#_development">4.3. Development</a></li>
<li><a href="#_build">4.4. Build</a></li>
<li><a href="#_deploy">4.5. Deploy</a></li>
<li><a href="#_shutdown">4.6. Shutdown</a>
<ul class="sectlevel3">
<li><a href="#_logging_2">4.6.1. Logging</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_storage_sdk">5. Storage SDK</a>
<ul class="sectlevel2">
<li><a href="#_plugin_details">5.1. Plugin Details</a></li>
<li><a href="#_resources">5.2. Resources</a></li>
<li><a href="#_schemas">5.3. Schemas</a></li>
<li><a href="#_implementation">5.4. Implementation</a></li>
</ul>
</li>
<li><a href="#_apis">6. APIs</a>
<ul class="sectlevel2">
<li><a href="#_provider_apis">6.1. Provider APIs</a></li>
<li><a href="#_storage_apis">6.2. Storage APIs</a>
<ul class="sectlevel3">
<li><a href="#_storage">6.2.1. Storage</a></li>
<li><a href="#_subsystem">6.2.2. Subsystem</a></li>
<li><a href="#_volume">6.2.3. Volume</a></li>
<li><a href="#_snapshot">6.2.4. Snapshot</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_automation_tests">7. Automation Tests</a>
<ul class="sectlevel2">
<li><a href="#_advantages_2">7.1. Advantages</a></li>
<li><a href="#_usage">7.2. Usage</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/IBM-logo.png" alt="IBM-logo">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Copyright 2019 IBM | All rights reserved | Confidential

The contents of this document and any attachments are strictly confidential and are supplied on the understanding that they will be held confidentially and not disclosed to third parties without the prior written consent of IBM.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The storage SDK is a Python based web application framework that can significantly help in building new storage plugins. This framework offers Platform as a service.</p>
</div>
<div class="paragraph">
<p>The SDK includes APIs to deal with storage resources like volume and snapshot . There is also a stub implementation included of the storage interface.</p>
</div>
<div class="paragraph">
<p>SPP needs to handle many different types of storage for supporting backup and restore. In the process, it issues a well defined set of commands to the underlying storage (such as creation of a volume or taking a snapshot of a volume). These set of commands are now defined in the form of REST APIs so that a specific implementation can be provided for each type of storage.</p>
</div>
<div class="sect2">
<h3 id="_advantages">1.1. Advantages</h3>
<div class="ulist">
<ul>
<li>
<p>Quicker plugin implementation for different storage</p>
</li>
<li>
<p>Horizontal scaling</p>
</li>
<li>
<p>Conforms to the SPP interface and hence makes adding more features easy</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">2. Overview</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The storage plugin will be deployed in an SPP appliance which will provide it Kubernetes services.</p>
</li>
<li>
<p>SPP will communicate with the SDK by making API calls to the plugin which in turn will communicate with the storage itself.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/overview.png" alt="Overview"></span></p>
</div>
<div class="sect2">
<h3 id="_terminology">2.1. Terminology</h3>
<div class="ulist">
<ul>
<li>
<p>Resources: These comprise of the high level components of a storage. The storage SDK allows easy implementation of the CRUD opertaions on  the following resources:</p>
<div class="ulist">
<ul>
<li>
<p>system: Information about the storage itself.</p>
</li>
<li>
<p>subsystem: A subset of the storage system (e.g., a storage virtual machine, IO group or availability zone).</p>
</li>
<li>
<p>volume: A storage container that can be shared or directly connected to a client.</p>
</li>
<li>
<p>snapshot: A point-in-time representation of a volume.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Schemas : Each resource has a schema associated with it, these schemas define the format of the request and response for each resource and the api calls associated with the CRUD operation we can perform on  them</p>
</li>
<li>
<p>Implementation : Each resource also has an implementation file associate with it, this allows the developer to add the storage specific logic here</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_requirements">2.2. Requirements</h3>
<div class="paragraph">
<p>The SDK is deployed within a Docker container alongside Mongo and Redis containers within a private network.
This container orchestration is handled by Docker Compose.
The Makefile provides helper commands to build, deploy, shutdown, etc. To view a complete list of commands, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ make help

build                          Build the SDK docker image (optional args: DOCKER_REGISTRY, IMAGE_NAME, BUILD_VERSION)
clean                          Clean the workspace
deploy                         Deploy the SDK docker image (optional args: DOCKER_REGISTRY, IMAGE_NAME, BUILD_VERSION)
pushimage                      Push the SDK docker images to the registry (optional args: DOCKER_REGISTRY, IMAGE_NAME, BUILD_VERSION)
shutdown                       Shutdown the SDK containers</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Requirements</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Minimum Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Compose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU Make</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Specific requirements for <strong>Windows</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cygwin.com">Cygwin</a> is required to run Make and other GNU tools.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">3. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To simplify the development process a sample Storage SDK has been provided which will return dummy data for each API call. This is a good starting point for a developer to see the storage plugin in action.</p>
</div>
<div class="paragraph">
<p>Follow the steps to build and deploy the sample SDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clone the repository storagesdk</p>
</li>
<li>
<p>go to STORAGE_SDK_dummy directory</p>
</li>
<li>
<p>Run the following commands to get the docker containers up and running on your local system:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">make build IMAGE_NAME=&lt;your_sdk_name&gt;

make deploy</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To check if the plugin is up use the following command, this will list all the docker containers running on your system. The container that is up on port 12002 is the the sample sdk.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>docker ps

#You must see something similar to following output i.e the list of containers:

CONTAINER ID        IMAGE                                                       COMMAND                  CREATED             STATUS              PORTS                   NAMES
303c5fb3e057        docker-registry.devad.catalogic.us:5000/sample_sdk:latest   "supervisord -c /etc…"   21 hours ago        Up 21 hours         0.0.0.0:12002-&gt;80/tcp   workspace_sdk_1
8830ed614009        mongo                                                       "docker-entrypoint.s…"   13 days ago         Up 13 days          27017/tcp               workspace_mongo_1
43dcd4650eaa        redis                                                       "docker-entrypoint.s…"   13 days ago         Up 13 days          6379/tcp                workspace_redis_1</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>At this point you have a bare-bones plugin up and running, serving dummy data at port 12002.</p>
</li>
<li>
<p>Test the sample SDK by running the set of automation tests already provided. To run these tests follow the steps below:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"># goto the directory tests

$ ./runtests.sh storage_tests.py</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To call individual APIs you may use curl commands or an API tool e.x Postman google-chrome extension.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"># Sample POST call using curl:

curl -X POST \
 http://localhost:12002/api/common/provider \
 -H 'Accept: /' \
 -H 'Content-Type: application/json' \
 -d '{"username":"test_name",
    "password": "test_pass"
}'</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_framework">4. Framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="./images/framework.png" alt="Microservice Platfrom"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Storage SDK is a Docker image comprised of a web application and a task queue.</p>
</li>
<li>
<p>The web application is powered by Flask and is served using Nginx and uWSGI.</p>
</li>
<li>
<p>All the API endpoints have the URL prefix <code>/api</code>.</p>
</li>
<li>
<p>Already included in the API are some common endpoints with the URL prefix <code>/api/common</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>POST /api/common/provider</code> - set provider information and get <code>provider_id</code>.</p>
</li>
<li>
<p><code>GET /api/common/system</code> - get system information.</p>
</li>
<li>
<p><code>GET /api/common/task/{task_id}</code> - get task status and response.</p>
</li>
<li>
<p><code>GET /api/common/log | /api/common/log/{provider_id}</code> - retrieve all logs or logs for a specific provider.</p>
</li>
</ul>
</div>
</li>
<li>
<p>With the exception of the common endpoints, any API requests made will be converted into a task with an associated <code>task_id</code> and <code>status</code>, which can then be polled for a response.</p>
</li>
<li>
<p>The tasks are queued in Redis and is eventually executed by Celery.</p>
</li>
<li>
<p>Task responses are stored in MongoDB.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_documentation">4.1. Documentation</h3>
<div class="paragraph">
<p>API documentation for the Storage SDK is dynamically generated and can be found in <code>/swagger-ui</code>.
===
The Storage SDK is a Docker image comprised of a web application and a task queue.
The web application is powered by Flask and is served using Nginx and uWSGI.
All the API endpoints have the URL prefix <code>/api</code>. Already included in the API are some common endpoints with the URL prefix <code>/api/common</code>. With the exception of the common endpoints, any API requests made will be converted into a task with an associated <code>task_id</code> and <code>status</code>, which can then be polled for a response.
The tasks are queued in Redis and is eventually executed by Celery. The responses are then stored in MongoDB.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging">4.2. Logging</h3>
<div class="paragraph">
<p>All logs are stored in <code>/opt/platform/log</code> within the container.</p>
</div>
</div>
<div class="sect2">
<h3 id="_development">4.3. Development</h3>
<div class="paragraph">
<p>The following are files and folders used by the Storage SDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>app.py - register blueprints, setup provider creation, and configure Swagger documentation</p>
</li>
<li>
<p>requirements.txt - list of Python dependencies</p>
</li>
<li>
<p>resources/ - various blueprints where all the API routes are defined</p>
</li>
<li>
<p>schemas/ - request and response data</p>
</li>
<li>
<p>implementation/ - actual execution of the API endpoints</p>
</li>
<li>
<p>VERSION - specifies SDK image version</p>
</li>
<li>
<p>Dockerfile - creates an image using all the required files</p>
</li>
<li>
<p>docker-compose.yaml - define environment variables, port, and deploy the Storage SDK, Redis, and MongoDB</p>
</li>
<li>
<p>Makefile - build, deploy, and shutdown commands</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_build">4.4. Build</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">make build</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will create a <code>workspace</code> directory,
copy and update a few files with some required information,
and build the docker image.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deploy">4.5. Deploy</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">make deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will update a few files in the <code>workspace</code> directory with some required information
and then deploy the SDK along with Redis and MongoDB.</p>
</div>
</div>
<div class="sect2">
<h3 id="_shutdown">4.6. Shutdown</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">make shutdown</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will shutdown the running Storage SDK, Redis, and MongoDB Docker containers.</p>
</div>
<div class="sect3">
<h4 id="_logging_2">4.6.1. Logging</h4>
<div class="paragraph">
<p>All logs are stored in <code>/opt/platform/log</code> within the container.
&lt;&lt;&lt;</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_storage_sdk">5. Storage SDK</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_plugin_details">5.1. Plugin Details</h3>
<div class="paragraph">
<p><span class="image"><img src="./images/plugin.png" alt="Plugin framework"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Asynchronous api implementation is supported by the plugin</p>
</li>
<li>
<p>All the plugin API endpoints have the URL prefix <code>/api/storage</code></p>
</li>
<li>
<p>Each api call made to the plugin will return a task id which needs to be used to poll for the response</p>
</li>
<li>
<p>Use the task id from the response to the plugin api and make a call to the framework  <code>/api/common/&lt;task-id&gt;</code> to get the response and task status</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_resources">5.2. Resources</h3>
<div class="ulist">
<ul>
<li>
<p>Storage</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Information about the storage itself.</p>
</div>
<div class="paragraph">
<p>Storage Info</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
	"name": "",
	"api_version": 1,
    "system_id": "",
    "support_summary": {
    },
    "supports_subsystems": true
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Subsystem</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A subset of the storage system (e.g., a storage virtual machine, IO group or availability zone).</p>
</div>
<div class="paragraph">
<p>Subsystem Info</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
    "name": "",
    "subsystem_id": "",
    "support_summary", {}
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Volume</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A storage container that can be shared or directly connected to a client.</p>
</div>
<div class="paragraph">
<p>Volume Info</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
    "name": "",
    "volume_id": "",
    "max_name_length" = 256
    "size": 0,
    "used_size": = 0,
    "creation_time": "",
    "subsystem_id": "",
    "type": "",
    "snapshot_id": null,
    "client_access_support": {
        "lun": false,
        "share": false,
        "attachment": true
    },
	"volume_metadata": {},
	"ready": true
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Snapshot</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A point-in-time representation of a volume.</p>
</div>
<div class="paragraph">
<p>Snapshot Info</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
    "snapshot_id": "",
    "name": "",
    "subsystem_id": "",
    "volume_id": "",
    "creation_time": ""
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_schemas">5.3. Schemas</h3>
<div class="paragraph">
<p>The predefined schemas for all the storage resources allows us to easily use them to define the request and responses for each api associated with the resources.</p>
</div>
<div class="paragraph">
<p>We use python Marshmallow to define schemas. To read more about how to
define schemas use the following link:</p>
</div>
<div class="paragraph">
<p><a href="https://marshmallow.readthedocs.io/en/2.x-line/" class="bare">https://marshmallow.readthedocs.io/en/2.x-line/</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provider Details
This schema is an exception as this needs to be defined by the developer.
To communicate with a specific storage ex. Amazon EBS, Azure, you need
to create a connection with it. This information is referred to as provider data in this SDK.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So that the framework can store these details for you, you need to define the provider
details model and schema. Use the following example as reference.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provider Schema</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs"># Provider Create Model

class ProviderCreateModel(object):
    def __init__(self, username=None, password=None):
        self.username = username
        self.password = password

# Provider Schema

class ProviderCreateSchema(Schema):

    username = fields.Str(required=True, missing="")
    password = fields.Str(required=True, missing="")

    @post_load
    def make_session(self, data):
        return ProviderCreateModel(**data)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Storage Schema</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the StorageFormat class to return the storage details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs"># Storage Format

class StorageFormat:
    def __init__(self, name, api_version, system_id, support_summary, support_subsystem):
        self.name = name
        self.api_version = api_version
        self.system_id = system_id
        self.support_summary = support_summary
        self.support_subsystem = support_subsystem</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Subsystem Schema</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the SubsystemFormat class to return the subsystem details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs"># Subsystem Format

class SubsystemFormat:
    def __init__(self, name, subsystem_id, support_summary):
        self.name = name
        self.system_id = subsystem_id
        self.support_summary = support_summary</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Volume Schema</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the volume resource we can perform CRUD operations, in order to do so we have to make
use of the following schemas.</p>
</div>
<div class="paragraph">
<p>Use the VolumeFormat class to return volume details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs"># Volume Format

class VolumeFormat():

    def __init__(self, subsystem_id, volume_id, creation_time, volume_metadata,
                 size, snapshot_id, status, type, client_access_support, name=None, tags= None, max_name_length='256',
                 used_size='0'):

        self.name = name
        self.tags = tags
        self.subsystem_id = subsystem_id
        self.volume_id = volume_id
        self.max_name_length = max_name_length
        self.creation_time = creation_time
        self.volume_metadata = volume_metadata
        self.size = size
        self.used_size = used_size
        self.snapshot_id = snapshot_id
        self.status = status
        self.type = type
        self.client_access_support = client_access_support


# Create Volume

class VolumeCreateSchema(Schema):
    subsystem_id = fields.Str(required=True, missing="")
    snapshot_id = fields.Str(required=True, missing="")
    name = fields.Str()
    size = fields.Int(description="The size of the volume, in GiBs")
    type = fields.Str(description="")

    @post_load
    def make_volume(self, data):
        return VolumeCreateModel(**data)

# Update Volume

class VolumeUpdateSchema(Schema):
        DryRun = fields.Boolean()
        Size = fields.Int()
        VolumeType = fields.Str(description="")
        Iops = fields.Str(description="")

        @post_load
        def update_volume(self, data):
            return VolumeUpdateModel(**data)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Snapshot Schema</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the snapshot resource we can perform CRUD operations, in order to do so we have to make
use of the following schemas.</p>
</div>
<div class="paragraph">
<p>Use the SnapshotFormat class to return volume details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs"># Snapshot Format

class SnapshotFormat():

    def __init__(self, name, subsystem_id, volume_id, creation_time, snapshot_id):
        self.name = name
        self.subsystem_id = subsystem_id
        self.volume_id = volume_id
        self.creation_time = creation_time
        self.snapshot_id = snapshot_id

# Create Snapshot

class SnapCreateSchema(Schema):
        volume_id = fields.Str(required=True, missing="")
        name = fields.Str()
        subsystem_id = fields.Str()

        @post_load
        def make_snapshot(self, data):
            return SnapCreateModel(**data)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementation">5.4. Implementation</h3>
<div class="paragraph">
<p>Each resource has a class associated to an operation that can be performed with the
resource. The user needs to write implementation for these classes in order to talk to
their specific storage.</p>
</div>
<div class="paragraph">
<p>Storage Context</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The storage_context is passed to each resource class by the resources, this is the provider information the user can use to create a connection with their specific storage and use it to make each API call.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Format Response</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The  user needs to keep in mind that during the implementation of these classes it is the responsibility of the user to format the response of each api as per the resource format class.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Storage</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs">class StorageImpl():

    def __init__(self, storage_context):
        self.storage_context = storage_context
        self. storage_session = None

    def get_details(self):
        storage = None

       # Implementation

        return storage</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Subsystem</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs">class SubsystemImpl():

    def __init__(self, storage_context):
        self.storage_context = storage_context

    def get_all_subsystems(self):
        subsystems = []

        # Implementation

        return subsystems

    def get_subsytem_byid(self, subsystem_id):

        subsystem = None

        # Implementation

        return subsystem</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Volume</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs">class VolumeImpl():

    def __init__(self, storage_context):
        self.storage_context = storage_context

    def get_all_volumes(self, page_size=100, page_ctx=''):
        all_formated_volumes = []
        token = None

        # Implementation

        return all_formated_volumes, token

    def create_volume(self, postrequest):
        schema = volume_schema.VolumeCreateSchema()
        get_request = schema.load(postrequest)
        volume_request = postrequest
        volume_response = None

        # Implementation

        return volume_response

    def get_volume_byid(self, volume_id):
        volume_response = None

        # Implementation

        return volume_response

    def update_volume(self, volume_id):
        volume_response = None

        # Implementation

        return volume_response

    def delete_volume(self, volume_id):

        # Implementation

        return {}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Snapshot</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs">class SnapshotImpl():

    def __init__(self, storage_context):
        self.storage_context = storage_context

    def get_all_snapshots(self, page_size=100, page_ctx='', volume_id=None, subsystem_id=None):
        all_formated_snaps = []
        token = None

        # Implementation

        return all_formated_snaps, token

    def create_snapshot(self, postrequest):
        schema = snapshot_schema.SnapCreateSchema()
        snap_request = schema.load(postrequest)
        snapshot_request = postrequest
        snapshot_response = None

        # Implementation

        return snapshot_response

    def get_snapshot_byid(self, snapshot_id):
        snapshot_response = None

        # Implementation

        return snapshot_response

    def update_snapshot(self, snapshot_id):
        snapshot_response = None

        # Implementation

        return snapshot_response

    def delete_snapshot(self, snapshot_id):

        # Implementation

        return {}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apis">6. APIs</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_provider_apis">6.1. Provider APIs</h3>
<div class="paragraph">
<p>This is the first API call made to generate a provider-id which must be used in all other api calls.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>POST /api/common/provider</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each API call made other than the one to generate provider-id, will return a task-id. To poll over this task and to get the response for the API call made use the following call:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GET /api/common/task/&lt;task-id&gt;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_storage_apis">6.2. Storage APIs</h3>
<div class="paragraph">
<p>All storage SDK endpoints use prefix <code>/api/storage/&lt;provider-id&gt;</code></p>
</div>
<div class="sect3">
<h4 id="_storage">6.2.1. Storage</h4>
<div class="ulist">
<ul>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_subsystem">6.2.2. Subsystem</h4>
<div class="ulist">
<ul>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/subsystem</p>
</li>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/subsystem/&lt;subsystem-id&gt;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_volume">6.2.3. Volume</h4>
<div class="ulist">
<ul>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/volume</p>
</li>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/volume/&lt;volume-id&gt;</p>
</li>
<li>
<p>POST /api/storage/&lt;provider-id&gt;/volume</p>
</li>
<li>
<p>PUT /api/storage/&lt;provider-id&gt;/volume/&lt;volume-id&gt;</p>
</li>
<li>
<p>DELETE /api/storage/&lt;provider-id&gt;/volume/&lt;volume-id&gt;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_snapshot">6.2.4. Snapshot</h4>
<div class="ulist">
<ul>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/snapshot</p>
</li>
<li>
<p>GET /api/storage/&lt;provider-id&gt;/snapshot/&lt;snapshot-id&gt;</p>
</li>
<li>
<p>POST /api/storage/&lt;provider-id&gt;/snapshot</p>
</li>
<li>
<p>PUT /api/storage/&lt;provider-id&gt;/snapshot/&lt;snapshot-id&gt;</p>
</li>
<li>
<p>DELETE /api/storage/&lt;provider-id&gt;/snapshot/&lt;snapshot-id&gt;</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_tests">7. Automation Tests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_advantages_2">7.1. Advantages</h3>
<div class="paragraph">
<p>These test provide a platform for TDD [Test Driven Development]</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identify the error/problem quickly</p>
</li>
<li>
<p>Reduces time spent on rework</p>
</li>
<li>
<p>Fast feedback</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_usage">7.2. Usage</h3>
<div class="paragraph">
<p>Update the pytest.ini file with the following details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ini" class="language-ini hljs">[pytest]
addopts = -p no:warnings

[endpoint]
url = http://localhost:&lt;port-number&gt;

[credentials]

[volume]
Size = 10

[pagination]
pageSize = 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the ini file is updated, add provider request body in the storage_test.py file. Now you can run the storage tests using Pytest testing framework.
To learn more about Pytest use the following link:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.pytest.org/en/latest/" class="bare">https://docs.pytest.org/en/latest/</a></p>
</div>
<div class="paragraph">
<p>To run the tests use the following commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"># goto the tests directory

$ ./runtests.sh storage_tests.py</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-09-10 20:03:31 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>